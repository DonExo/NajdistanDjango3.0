{% extends 'base.html' %}
{% load humanize %}

{% block title %}
    {% include 'includes/title.html' %}
{% endblock %}

{% block content %}
    <h1>Profile page</h1>
    <h3>Hello {{ user.first_name }}</h3><br/>
    <img src="{{ user.get_profile_image }}" alt="Profile image" width="150" height="150"/>
    <h6>Last login: {{ user.last_login|naturaltime }}</h6>
    Fullname: {{ user.get_full_name }} <br/>
    <h3>Create <a href="{% url 'listings:create' %}">New listing</a> </h3>
    <h4><a href="{% url 'auth_password_change' %}">Change your password</a> </h4>
    <h4><a href="{% url 'accounts:update_user' %}">Update your profile</a> </h4>
    <h4>Your listings:</h4>
    {% if listings %}
        {% for object in listings %}
            {% include 'listings/card.html' %}
        {% endfor %}
    {% else %}
        <p>You don't have any listings. Would you like to <a href="{% url 'listings:create' %}">create one?</a></p>
    {% endif %}

    <br/>

    <h3>Add new <a href="{% url 'accounts:sp_create' %}">Search Profile</a></h3>
    <h4>Your Search Profiles:</h4>
    {% if search_profiles %}
        {% for sp in search_profiles %}
            <p>
                {{ sp.title }} - {{ sp.city }} - {{ sp.listing_type }} - {{ sp.min_rooms }}
                - {{ sp.min_bedrooms }} - Price range: {{ sp.min_price }}: {{ sp.max_price }}
                - {{ sp.interior }} - {{ sp.frequency }} - {{ sp.is_active }}
                - <a href="{% url 'accounts:sp_update' sp.pk %}">Update</a>
                - <a href="{% url 'accounts:sp_delete' sp.pk %}"
                     onclick="return confirm('Are you sure you want to delete this listing?')">Delete
                  </a>
                - <a href="{% url 'accounts:sp_toggle' sp.pk %}">{% if sp.is_active %}Disable{% else %}Enable{% endif %}</a>
            </p>
        {% endfor %}
    {% else %}
        <p>You don't have any Search Profiles. Would you like to <a href="{% url 'accounts:sp_create' %}">create one?</a></p>
    {% endif %}
{% endblock %}